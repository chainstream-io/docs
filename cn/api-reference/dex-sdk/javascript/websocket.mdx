---
title: 'WebSocket'
description: 'WebSocket 实时数据订阅服务'
---

本文档描述了 ChainStream JavaScript SDK 提供的 WebSocket 订阅方法。每个方法都是对应 WebSocket API 的封装，详细的参数说明和返回值结构请点击对应的 API 链接查看。

## K线
- <code>[client.stream.subscribeTokenCandles()](/cn/api-reference/endpoint/websocket/api#k线数据)</code>

## Token
- <code>[client.stream.subscribeTokenStats()](/cn/api-reference/endpoint/websocket/api#代币统计)</code>
- <code>[client.stream.subscribeTokenHolders()](/cn/api-reference/endpoint/websocket/api#代币持有者统计)</code>
- <code>[client.stream.subscribeNewToken()](/cn/api-reference/endpoint/websocket/api#新代币信息)</code>
- <code>[client.stream.subscribeNewTokensMetadata()](/cn/api-reference/endpoint/websocket/api#新代币元数据)</code>
- <code>[client.stream.subscribeTokenSupply()](/cn/api-reference/endpoint/websocket/api#代币供应量)</code>
- <code>[client.stream.subscribeTokenLiquidity()](/cn/api-reference/endpoint/websocket/api#代币流动性)</code>

## Ranking
- <code>[client.stream.subscribeRankingTokensLiquidity()](/cn/api-reference/endpoint/websocket/api#排名的代币流动性数据)</code>
- <code>[client.stream.subscribeRankingTokensList()](/cn/api-reference/endpoint/websocket/api#排名的代币列表)</code>
- <code>[client.stream.subscribeRankingTokensStats()](/cn/api-reference/endpoint/websocket/api#排名的代币统计数据)</code>
- <code>[client.stream.subscribeRankingTokensHolders()](/cn/api-reference/endpoint/websocket/api#排名的代币持有者统计)</code>
- <code>[client.stream.subscribeRankingTokensSupply()](/cn/api-reference/endpoint/websocket/api#排名的代币供应量数据)</code>

## Wallet
- <code>[client.stream.subscribeWalletBalance()](/cn/api-reference/endpoint/websocket/api#钱包余额)</code>
- <code>[client.stream.subscribeWalletPnl()](/cn/api-reference/endpoint/websocket/api#钱包盈亏数据（代币级别）)</code>
- <code>[client.stream.subscribeWalletPnlList()](/cn/api-reference/endpoint/websocket/api#钱包盈亏数据（钱包级别）)</code>

## Trade
- <code>[client.stream.subscribeTokenTrade()](/cn/api-reference/endpoint/websocket/api#代币交易)</code>
- <code>[client.stream.subscribeWalletTrade()](/cn/api-reference/endpoint/websocket/api#钱包交易)</code>

## DexPool
- <code>[client.stream.subscribeDexPoolBalance()](/cn/api-reference/endpoint/websocket/api#dex-资金池余额)</code>


## 连接管理

调用 `subscribeXXX` 方法时，SDK 会自动检测 WebSocket 连接状态，如果未连接会自动建立连接，无需手动调用 `connect()`。

如果需要提前建立连接（例如减少首次订阅的延迟），可以手动调用：
```typescript
client.stream.connect()
```

所有订阅方法都会返回一个 `Unsubscrible` 对象，可以用于取消订阅：

```typescript
const subscription = client.stream.subscribeTokenCandles(/* ... */);
// 取消订阅
subscription.unsubscribe();
```

## 批量订阅

批量订阅多个数据流
### 使用示例

```typescript
const unsubscribles = client.stream.batchSubscribe(() => [
  client.stream.subscribeWalletBalance({
    chain: 'sol',
    walletAddress: "wallet address 1",
    callback: (data: WalletBalance[]) => {
        // todo
    }
  }),
  
  client.stream.subscribeWalletBalance({
    chain: 'sol',
    walletAddress: "wallet address 2",
    callback: (data: WalletBalance[]) => {
        // todo
    }
  })
]);
```

详细的参数说明、数据格式和错误处理请参考 [WebSocket API 文档](/cn/api-reference/endpoint/websocket/api)。 