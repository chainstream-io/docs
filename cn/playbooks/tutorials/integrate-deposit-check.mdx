---
title: 'é›†æˆå……å€¼é£æ§'
description: 'ä½¿ç”¨ KYT API æ„å»ºäº¤æ˜“æ‰€å……å€¼é£é™©æ£€æµ‹ç³»ç»Ÿ'
icon: 'shield-check'
---

## é¡¹ç›®æ¦‚è¿°

æœ¬æ•™ç¨‹æ„å»ºä¸€ä¸ªå……å€¼é£æ§ç³»ç»Ÿï¼Œåœ¨ç”¨æˆ·å……å€¼æ—¶è‡ªåŠ¨è¯„ä¼°èµ„é‡‘æ¥æºé£é™©ã€‚

<Info>
**é¢„è®¡æ—¶é—´**ï¼š30 åˆ†é’Ÿ  
**éš¾åº¦ç­‰çº§**ï¼šâ­â­ å…¥é—¨
</Info>

**åŠŸèƒ½**ï¼š
- æ³¨å†Œå……å€¼äº¤æ˜“è¿›è¡Œ KYT åˆ†æ
- æŸ¥è¯¢äº¤æ˜“é£é™©è¯„ä¼°ç»“æœ
- æ ¹æ®é£é™©ç­‰çº§å¤„ç†å……å€¼

---

## å·¥ä½œåŸç†

```mermaid
flowchart TD
    A[ç”¨æˆ·å……å€¼] --> B[æ³¨å†Œäº¤æ˜“åˆ° KYT]
    B --> C[è·å–äº¤æ˜“æ‘˜è¦]
    C --> D{é£é™©ç­‰çº§?}
    D -->|ä½é£é™©| E[æ‰¹å‡†å……å€¼]
    D -->|ä¸­é£é™©| F[äººå·¥å®¡æ ¸]
    D -->|é«˜é£é™©| G[æ‹’ç»å……å€¼]
```

---

## Step 1ï¼šæ³¨å†Œå……å€¼äº¤æ˜“

å½“æ£€æµ‹åˆ°å……å€¼æ—¶ï¼Œå°†äº¤æ˜“æ³¨å†Œåˆ° KYT API è¿›è¡Œåˆ†æã€‚

```javascript
import { ChainStreamClient } from '@chainstream-io/sdk';

const client = new ChainStreamClient(process.env.CHAINSTREAM_ACCESS_TOKEN);

async function registerDeposit(deposit) {
  // æ³¨å†Œäº¤æ˜“è¿›è¡Œ KYT åˆ†æ
  const response = await client.kyt.registerTransfer({
    network: deposit.network,        // 'bitcoin', 'ethereum', 'Solana'
    asset: deposit.asset,            // 'BTC', 'ETH', 'SOL'
    transferReference: deposit.txHash, // äº¤æ˜“å“ˆå¸Œ
    direction: 'received'            // å……å€¼ = received
  });

  return response.transferId;
}
```

---

## Step 2ï¼šè·å–é£é™©è¯„ä¼°

æ³¨å†Œåï¼ŒæŸ¥è¯¢äº¤æ˜“æ‘˜è¦è·å–é£é™©ä¿¡æ¯ã€‚

```javascript
async function getTransferRisk(transferId) {
  // è·å–å¸¦é£é™©è¯„ä¼°çš„äº¤æ˜“æ‘˜è¦
  const summary = await client.kyt.getTransferSummary(transferId);

  // è·å–è¯¦ç»†è­¦æŠ¥ä¿¡æ¯
  const alerts = await client.kyt.getTransferAlerts(transferId);

  // è·å–ç›´æ¥é£é™©æ•å£ä¿¡æ¯
  const exposures = await client.kyt.getTransferDirectExposure(transferId);

  return {
    summary,
    alerts,
    exposures
  };
}
```

---

## Step 3ï¼šæ ¹æ®é£é™©å¤„ç†

å®ç°åŸºäºé£é™©çš„å¤„ç†é€»è¾‘ã€‚

```javascript
async function evaluateDeposit(deposit) {
  // æ³¨å†Œå……å€¼
  const transferId = await registerDeposit(deposit);

  // è·å–é£é™©è¯„ä¼°
  const { summary, alerts, exposures } = await getTransferRisk(transferId);

  // æ ¹æ®è­¦æŠ¥åˆ¤æ–­é£é™©ç­‰çº§
  const hasHighRiskAlert = alerts.some(
    alert => alert.severity === 'high' || alert.severity === 'critical'
  );
  const hasMediumRiskAlert = alerts.some(
    alert => alert.severity === 'medium'
  );

  // æ ¹æ®é£é™©å¤„ç†
  if (hasHighRiskAlert) {
    return rejectDeposit(deposit, alerts);
  }

  if (hasMediumRiskAlert) {
    return queueForReview(deposit, alerts);
  }

  return approveDeposit(deposit);
}

function approveDeposit(deposit) {
  console.log(`âœ… å……å€¼å·²æ‰¹å‡†: ${deposit.txHash}`);
  // ä¸ºç”¨æˆ·è´¦æˆ·å…¥è´¦
  return { status: 'approved', deposit };
}

function queueForReview(deposit, alerts) {
  console.log(`âš ï¸ å……å€¼å¾…å®¡æ ¸: ${deposit.txHash}`);
  // é€šçŸ¥åˆè§„å›¢é˜Ÿ
  return { status: 'pending_review', deposit, alerts };
}

function rejectDeposit(deposit, alerts) {
  console.log(`âŒ å……å€¼å·²æ‹’ç»: ${deposit.txHash}`);
  // è®°å½•å¹¶é€šçŸ¥
  return { status: 'rejected', deposit, alerts };
}
```

---

## å®Œæ•´ç¤ºä¾‹

```javascript
import { ChainStreamClient } from '@chainstream-io/sdk';

const client = new ChainStreamClient(process.env.CHAINSTREAM_ACCESS_TOKEN);

class DepositRiskChecker {
  async checkDeposit(deposit) {
    try {
      // Step 1: æ³¨å†Œäº¤æ˜“
      const { transferId } = await client.kyt.registerTransfer({
        network: deposit.network,
        asset: deposit.asset,
        transferReference: deposit.txHash,
        direction: 'received'
      });

      console.log(`ğŸ“ å·²æ³¨å†Œäº¤æ˜“: ${transferId}`);

      // Step 2: è·å–é£é™©è¯„ä¼°
      const summary = await client.kyt.getTransferSummary(transferId);
      const alerts = await client.kyt.getTransferAlerts(transferId);

      console.log(`ğŸ“Š é£é™©è¯„ä¼°å®Œæˆ`);
      console.log(`   è­¦æŠ¥æ•°é‡: ${alerts.length}`);

      // Step 3: åšå‡ºå†³ç­–
      return this.makeDecision(deposit, summary, alerts);

    } catch (error) {
      console.error(`âŒ æ£€æŸ¥å……å€¼æ—¶å‡ºé”™: ${error.message}`);
      // å‡ºé”™æ—¶ï¼Œæ’é˜Ÿäººå·¥å®¡æ ¸
      return { status: 'pending_review', reason: 'system_error' };
    }
  }

  makeDecision(deposit, summary, alerts) {
    const criticalAlerts = alerts.filter(a => a.severity === 'critical');
    const highAlerts = alerts.filter(a => a.severity === 'high');
    const mediumAlerts = alerts.filter(a => a.severity === 'medium');

    if (criticalAlerts.length > 0 || highAlerts.length > 0) {
      return {
        status: 'rejected',
        reason: 'high_risk_detected',
        alerts: [...criticalAlerts, ...highAlerts]
      };
    }

    if (mediumAlerts.length > 0) {
      return {
        status: 'pending_review',
        reason: 'medium_risk_detected',
        alerts: mediumAlerts
      };
    }

    return {
      status: 'approved',
      reason: 'low_risk'
    };
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const checker = new DepositRiskChecker();

const deposit = {
  network: 'Solana',
  asset: 'SOL',
  txHash: '39z5QAprVrzaFzfHu1JHPgBf9dSqYdNYhH31d3PEd4hWiWL1LML7qCct5MHGxaRAgjjj1nC3XUyLwtzGQmYqUk4y:address'
};

const result = await checker.checkDeposit(deposit);
console.log('å†³ç­–ç»“æœ:', result);
```

---

## API å‚è€ƒ

| ç«¯ç‚¹ | æè¿° |
|------|------|
| `POST /v1/kyt/transfer` | æ³¨å†Œäº¤æ˜“è¿›è¡Œ KYT åˆ†æ |
| `GET /v1/kyt/transfers/{id}/summary` | è·å–äº¤æ˜“æ‘˜è¦ |
| `GET /v1/kyt/transfers/{id}/alerts` | è·å–äº¤æ˜“è­¦æŠ¥ |
| `GET /v1/kyt/transfers/{id}/exposures/direct` | è·å–ç›´æ¥é£é™©æ•å£ä¿¡æ¯ |

---

## ä¸‹ä¸€æ­¥

<CardGroup cols={2}>
  <Card title="KYT æ¦‚å¿µ" icon="magnifying-glass-dollar" href="/cn/guides/data-concepts/kyt-concepts">
    äº†è§£ KYT å·¥ä½œåŸç†
  </Card>
  <Card title="KYT API å‚è€ƒ" icon="code" href="/cn/api-reference/endpoint/kyt/v1/kyt-transfer-post">
    å®Œæ•´ API æ–‡æ¡£
  </Card>
</CardGroup>
