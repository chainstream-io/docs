---
title: 'WebSocket API'
description: 'WebSocket API Real-time Data Subscription Service'
---

## Overview

ChainStream DEX WebSocket API provides real-time data subscription services, supporting the following data types:
- Candle Data
- Token Statistics
- Token Activities
- Trade Events
- Token Holders
- Wallet Balance
- Token Balance

**Base URL**
```bash
wss://realtime-dex.chainstream.io/connection/websocket
```

## Quick Start

### 1. Establish Connection

First, create a WebSocket connection and authenticate:

```typescript
const ws = new WebSocket("wss://realtime-dex.chainstream.io/connection/websocket");

ws.onopen = () => {
  // Send authentication message
  ws.send(JSON.stringify({
    type: "auth",
    token: "YOUR_ACCESS_TOKEN"
  }));
};
```

### 2. Subscribe to Data

Choose the data type you want to subscribe to:

```typescript
// Example of subscribing to candle data
ws.send(JSON.stringify({
  type: "subscribe",
  channel: "dex-candle:sol_6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN_1m"
}));
```

### 3. Handle Data

```typescript
ws.onmessage = (event) => {
  const data = JSON.parse(event.data);
  console.log('Received data:', data);
};
```

## Data Subscriptions

### Candle Data

Get real-time price movement data for tokens.

**Subscription Format**
```text
dex-candle:{chain}_{tokenAddress}_{resolution}
```

**Parameters**
<ParamField query="chain" type="string" required>
  Blockchain name, e.g., sol
</ParamField>

<ParamField query="tokenAddress" type="string" required>
  Token contract address, e.g., 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN
</ParamField>

<ParamField query="resolution" type="string" required>
  Candle period, supports: 1m, 5m, 15m, 1h, 4h, 1d
</ParamField>

**Response Data**
```typescript
{
  "o": number,    // Open price
  "c": number,    // Close price
  "h": number,    // High price
  "l": number,    // Low price
  "v": number,    // Volume
  "r": string,    // Resolution
  "t": number     // Timestamp
}
```

### Token Statistics

Get real-time market statistics for tokens.

**Subscription Format**
```text
dex-token-stats:{chain}_{tokenAddress}
```

**Parameters**
<ParamField query="chain" type="string" required>
  Blockchain name, e.g., sol
</ParamField>

<ParamField query="tokenAddress" type="string" required>
  Token contract address, e.g., 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN
</ParamField>

**Response Data**
```typescript
{
  "price": {
    "usd": number,      // USD price
    "change_24h": number // 24h price change
  },
  "volume": {
    "usd_24h": number   // 24h trading volume (USD)
  },
  "market_cap": {
    "usd": number       // Market cap (USD)
  },
  "holders": number,    // Number of holders
  "timestamp": number   // Timestamp
}
```

### Token Activities

Get real-time token activity data.

**Subscription Format**
```text
dex-token-activities:{chain}_{tokenAddress}
```

**Parameters**
<ParamField query="chain" type="string" required>
  Blockchain name, e.g., sol
</ParamField>

<ParamField query="tokenAddress" type="string" required>
  Token contract address, e.g., 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN
</ParamField>

### Trade Events

Get real-time token trading events.

**Subscription Format**
```text
dex-trades:{chain}_{tokenAddress}
```

**Parameters**
<ParamField query="chain" type="string" required>
  Blockchain name, e.g., sol
</ParamField>

<ParamField query="tokenAddress" type="string" required>
  Token contract address, e.g., 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN
</ParamField>

**Response Data**
```typescript
{
  "bwa": string,  // Maker address
  "ba": number,   // Base token amount
  "sa": number,   // Quote token amount
  "swa": string,  // Quote token address
  "bais": number, // USD amount
  "t": number,    // Timestamp
  "k": string,    // Event type
  "h": string,    // Transaction hash
  "a": string     // Token address
}
```

### Wallet Balance

Get real-time wallet balance information.

**Subscription Format**
```text
dex-wallet-balance:{chain}_{walletAddress}
```

**Parameters**
<ParamField query="chain" type="string" required>
  Blockchain name, e.g., sol
</ParamField>

<ParamField query="walletAddress" type="string" required>
  Wallet address, e.g., HN7cABqLq46Es1jh92dQQisAq662SmxELLLsHHe4YWrH
</ParamField>

**Response Data**
```typescript
{
  "a": string,    // Wallet address
  "ta": string,   // Token address
  "tpiu": number, // Token price in USD
  "t": number,    // Timestamp
  "ba": number,   // Buy amount
  "baiu": number, // Buy amount in USD
  "bs": number,   // Number of buys
  "sa": number,   // Sell amount
  "saiu": number, // Sell amount in USD
  "ss": number,   // Number of sells
  "abp": number,  // Average buy price
  "asp": number,  // Average sell price
  "upiu": number, // Unrealized profit in USD
  "upr": number,  // Unrealized profit ratio
  "rpiu": number, // Realized profit in USD
  "rpr": number,  // Realized profit ratio
  "trpiu": number,// Total realized profit in USD
  "trr": number   // Total realized profit ratio
}
```

### Token Balance

Get real-time balance information for specific tokens.

**Subscription Format**
```text
dex-token-balance:{chain}_{tokenAddress}_{walletAddress}
```

**Parameters**
<ParamField query="chain" type="string" required>
  Blockchain name, e.g., sol
</ParamField>

<ParamField query="tokenAddress" type="string" required>
  Token contract address, e.g., 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN
</ParamField>

<ParamField query="walletAddress" type="string" required>
  Wallet address, e.g., HN7cABqLq46Es1jh92dQQisAq662SmxELLLsHHe4YWrH
</ParamField>

### Token Holders Statistics

Get real-time token holder statistics.

**Subscription Format**
```text
dex-token-general-stat-num:{chain}_{tokenAddress}
```

**Parameters**
<ParamField query="chain" type="string" required>
  Blockchain name, e.g., sol
</ParamField>

<ParamField query="tokenAddress" type="string" required>
  Token contract address, e.g., 6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN
</ParamField>

**Response Data**
```typescript
{
  "a": string,    // Token address
  "v": number,    // Number of holders
  "ts": number    // Timestamp
}
```

## Usage Examples

```typescript
const streamApi = new StreamApi(context);

// Subscribe to candle data
streamApi.subscribeTokenCandles({
  chain: "sol",
  tokenAddress: "6p6xgHyF7AeE6TZkSmFsko444wqoP15icUSqi2jfGiPN",
  resolution: "1m",
  callback: (data) => {
    console.log("Candle data:", data);
  }
});

// Subscribe to wallet balance
streamApi.subscribeWalletBalance({
  chain: "sol",
  walletAddress: "YOUR_WALLET_ADDRESS",
  callback: (data) => {
    console.log("Wallet balance:", data);
  }
});
```

### Reconnection Strategy

Recommended to use exponential backoff for reconnection:

```typescript
function reconnect(attempt) {
  const delay = Math.min(1000 * Math.pow(2, attempt), 10000);
  setTimeout(() => {
    connect();
  }, delay);
}
```

## Usage Limits

| Limit | Value | Description |
|-------|-------|-------------|
| Maximum Subscriptions | 100/connection | Excess will be rejected |
| Message Size | 100KB | Excess will be truncated |
| Heartbeat Interval | 30 seconds | Regular heartbeat required |

## Best Practices

1. **Connection Management**
   - Maintain a single WebSocket connection
   - Implement automatic reconnection
   - Send regular heartbeats

2. **Error Handling**
   - Implement complete error handling
   - Log detailed error information
   - Use exponential backoff for reconnection

3. **Performance Optimization**
   - Control subscription quantity
   - Implement message queue mechanism
   - Clean up unused subscriptions